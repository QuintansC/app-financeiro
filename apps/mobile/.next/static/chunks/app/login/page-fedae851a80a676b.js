(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{1702:(e,t,r)=>{"use strict";var a=r(99962);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})},22675:e=>{e.exports={container:"page_container__rY8xG",card:"page_card__nPipi",title:"page_title__TZ6P1",subtitle:"page_subtitle__dbd2I",error:"page_error__YqYLT",form:"page_form__7EXNE",field:"page_field__W88aP",label:"page_label__pnCcZ",input:"page_input__pky70",hint:"page_hint__YjX_O",button:"page_button__SKF7s",switch:"page_switch__4gliN",switchButton:"page_switchButton__SlcRz"}},46652:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var a=r(73365),s=r(1521),o=r(1702),i=r(78630),n=r(22675),l=r.n(n);function u(){let[e,t]=(0,s.useState)(""),[r,n]=(0,s.useState)(""),[u,c]=(0,s.useState)(""),[h,d]=(0,s.useState)(!1),[m,g]=(0,s.useState)(""),[_,f]=(0,s.useState)(!1),{login:p,register:v,isAuthenticated:b}=(0,i.A)(),w=(0,o.useRouter)();(0,s.useEffect)(()=>{b&&w.push("/")},[b,w]);let S=async t=>{t.preventDefault(),g(""),f(!0);try{if(!e.trim()){g("Email \xe9 obrigat\xf3rio"),f(!1);return}if(!r.trim()){g("Senha \xe9 obrigat\xf3ria"),f(!1);return}if(h){if(!u.trim()){g("Nome \xe9 obrigat\xf3rio"),f(!1);return}if(r.length<6){g("Senha deve ter no m\xednimo 6 caracteres"),f(!1);return}await v(e.trim(),r,u.trim())}else await p(e.trim(),r);w.push("/")}catch(e){g(e.message||(h?"Erro ao criar conta":"Erro ao fazer login"))}finally{f(!1)}};return(0,a.jsx)("div",{className:l().container,children:(0,a.jsxs)("div",{className:l().card,children:[(0,a.jsx)("h1",{className:l().title,children:h?"Criar Conta":"Login"}),(0,a.jsx)("p",{className:l().subtitle,children:h?"Crie sua conta para come\xe7ar a gerenciar suas finan\xe7as":"Entre para acessar seu sistema financeiro"}),m&&(0,a.jsx)("div",{className:l().error,children:m}),(0,a.jsxs)("form",{onSubmit:S,className:l().form,children:[h&&(0,a.jsxs)("div",{className:l().field,children:[(0,a.jsx)("label",{className:l().label,children:"Nome"}),(0,a.jsx)("input",{type:"text",className:l().input,value:u,onChange:e=>c(e.target.value),placeholder:"Seu nome",required:h,disabled:_})]}),(0,a.jsxs)("div",{className:l().field,children:[(0,a.jsx)("label",{className:l().label,children:"Email"}),(0,a.jsx)("input",{type:"email",className:l().input,value:e,onChange:e=>t(e.target.value),placeholder:"seu@email.com",required:!0,disabled:_})]}),(0,a.jsxs)("div",{className:l().field,children:[(0,a.jsx)("label",{className:l().label,children:"Senha"}),(0,a.jsx)("input",{type:"password",className:l().input,value:r,onChange:e=>n(e.target.value),placeholder:"••••••••",required:!0,minLength:6,disabled:_}),h&&(0,a.jsx)("small",{className:l().hint,children:"M\xednimo de 6 caracteres"})]}),(0,a.jsx)("button",{type:"submit",className:l().button,disabled:_,children:_?"Carregando...":h?"Criar Conta":"Entrar"})]}),(0,a.jsx)("div",{className:l().switch,children:(0,a.jsx)("button",{type:"button",className:l().switchButton,onClick:()=>{d(!h),g("")},disabled:_,children:h?"J\xe1 tem uma conta? Fa\xe7a login":"N\xe3o tem uma conta? Criar conta"})})]})})}},78630:(e,t,r)=>{"use strict";r.d(t,{AuthProvider:()=>h,A:()=>d});var a=r(73365),s=r(1521),o=r(1702);async function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let r=await fetch("".concat("http://localhost:3333/api").concat(e),{headers:{"Content-Type":"application/json",...t.headers||{}},...t});if(!r.ok){let e="Erro ao comunicar com a API";try{e=(await r.json()).message||e}catch(t){e=r.statusText||e}throw Error(e)}if(204===r.status)return null;return await r.json()}catch(e){if(e instanceof Error)throw e;throw Error(e.message||"Erro desconhecido")}}async function n(e,t){if(!e||!t)throw Error("Email e senha s\xe3o obrigat\xf3rios");if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.trim()))throw Error("Email inv\xe1lido");return i("/auth/login",{method:"POST",body:JSON.stringify({email:e.trim().toLowerCase(),password:t})})}async function l(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!e||!t)throw Error("Email e senha s\xe3o obrigat\xf3rios");if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.trim()))throw Error("Email inv\xe1lido");if(t.length<6)throw Error("Senha deve ter no m\xednimo 6 caracteres");return i("/auth/register",{method:"POST",body:JSON.stringify({email:e.trim().toLowerCase(),password:t,name:r.trim()})})}async function u(e){if(!e)throw Error("Token n\xe3o fornecido");return i("/auth/me",{method:"GET",headers:{Authorization:"Bearer ".concat(e)}})}let c=(0,s.createContext)(null);function h(e){let{children:t}=e,[r,i]=(0,s.useState)(null),[h,d]=(0,s.useState)(null),[m,g]=(0,s.useState)(!0),_=(0,o.useRouter)(),f=async e=>{try{let t=await u(e);if(!t||!t.user)throw Error("Resposta inv\xe1lida do servidor");i(t.user),d(e),g(!1)}catch(e){i(null),d(null),localStorage.removeItem("auth_token"),localStorage.removeItem("auth_user"),g(!1)}};(0,s.useEffect)(()=>{(async()=>{let e=localStorage.getItem("auth_token"),t=localStorage.getItem("auth_user");e&&t?(d(e),i(JSON.parse(t)),await f(e)):g(!1)})()},[]);let p=async(e,t)=>{try{let r=await n(e,t);if(!r||!r.user||!r.token)throw Error("Resposta inv\xe1lida do servidor");return i(r.user),d(r.token),localStorage.setItem("auth_token",r.token),localStorage.setItem("auth_user",JSON.stringify(r.user)),r}catch(e){throw e}},v=async(e,t,r)=>{try{let a=await l(e,t,r);if(!a||!a.user||!a.token)throw Error("Resposta inv\xe1lida do servidor");return i(a.user),d(a.token),localStorage.setItem("auth_token",a.token),localStorage.setItem("auth_user",JSON.stringify(a.user)),a}catch(e){throw e}};return(0,a.jsx)(c.Provider,{value:{user:r,token:h,loading:m,login:p,register:v,logout:()=>{i(null),d(null),localStorage.removeItem("auth_token"),localStorage.removeItem("auth_user"),_.push("/login")},isAuthenticated:!!r&&!!h},children:t})}function d(){let e=(0,s.useContext)(c);if(!e)throw Error("useAuth deve ser usado dentro de AuthProvider");return e}},83830:(e,t,r)=>{Promise.resolve().then(r.bind(r,46652))}},e=>{e.O(0,[838,347,131,358],()=>e(e.s=83830)),_N_E=e.O()}]);