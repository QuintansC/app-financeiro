(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[765],{1702:(e,a,r)=>{"use strict";var t=r(99962);r.o(t,"usePathname")&&r.d(a,{usePathname:function(){return t.usePathname}}),r.o(t,"useRouter")&&r.d(a,{useRouter:function(){return t.useRouter}})},4954:e=>{e.exports={container:"LoadingScreen_container__kroiF",spinner:"LoadingScreen_spinner__Id4H8",spin:"LoadingScreen_spin__CRGcH",message:"LoadingScreen_message__9M_gS"}},13876:(e,a,r)=>{"use strict";r.d(a,{c:()=>s});var t=r(1521),o=r(64785),n=r(98027);function s(){let[e,a]=(0,t.useState)(null),[r,s]=(0,t.useState)(!1),[i,l]=(0,t.useState)(!1),[c,u]=(0,t.useState)(null),d=(0,t.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{if(s(!0),u(null),!e){let e=(0,n.hi)();if(e){a(e),s(!1);try{let e=await (0,o.dR)();(0,n.H$)(e),a(e)}catch(e){console.warn("Erro ao atualizar cache em background:",e)}return}}let r=await (0,o.dR)();(0,n.H$)(r),a(r)}catch(r){let e=(0,n.hi)();e?(a(e),u("Erro ao atualizar dados. Mostrando dados em cache.")):u(r.message||"Erro ao carregar dados")}finally{s(!1)}},[]);(0,t.useEffect)(()=>{let e=(0,n.hi)();e&&a(e),d()},[d]);let m=(0,t.useCallback)(async e=>{l(!0),u(null);try{let a=await e();return(0,n.gm)(),await d(!0),a}catch(e){throw u(e.message||"Erro inesperado"),e}finally{l(!1)}},[d]);return{data:e,loading:r,operationLoading:i,error:c,refresh:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return d(e)},saveDebt:e=>m(()=>(0,o.cx)(e)),removeDebt:e=>m(()=>(0,o.BH)(e)),saveSalary:e=>m(()=>(0,o.C1)(e)),saveSavings:e=>m(()=>(0,o.Nt)(e)),saveMonth:e=>m(()=>(0,o.a1)(e)),savePreferences:(0,t.useCallback)(async e=>{try{await (0,o.PK)(e),a(a=>({...a,preferences:e}))}catch(e){throw u(e.message||"Erro ao salvar prefer\xeancias"),e}},[]),saveUser:e=>m(()=>(0,o.TK)(e))}}},43020:e=>{e.exports={container:"page_container__8qcJO",profileHeader:"page_profileHeader__D27Ni",avatarContainer:"page_avatarContainer__U5LsQ",avatar:"page_avatar__CZzWV",avatarPlaceholder:"page_avatarPlaceholder__eN6TN",avatarIcon:"page_avatarIcon__J5rh_",profileInfo:"page_profileInfo__Zx1aA",profileName:"page_profileName__s74Y6",profileEmail:"page_profileEmail__CeJTZ",formCard:"page_formCard__snzOp",formTitle:"page_formTitle__YpyQs",feedback:"page_feedback__jXRS1",slideIn:"page_slideIn__rabm_",success:"page_success__cF75E",error:"page_error__M9jQ_"}},44944:(e,a,r)=>{"use strict";r.d(a,{O:()=>l});var t=r(73365),o=r(1521),n=r(1702),s=r(78630),i=r(56545);function l(e){let{children:a}=e,{isAuthenticated:r,loading:l}=(0,s.A)(),c=(0,n.useRouter)();return((0,o.useEffect)(()=>{l||r||c.push("/login")},[r,l,c]),l)?(0,t.jsx)(i.x,{message:"Verificando autentica\xe7\xe3o..."}):r?a:null}},56545:(e,a,r)=>{"use strict";r.d(a,{x:()=>s});var t=r(73365),o=r(4954),n=r.n(o);function s(e){let{message:a="Carregando..."}=e;return(0,t.jsxs)("div",{className:n().container,children:[(0,t.jsx)("div",{className:n().spinner}),(0,t.jsx)("p",{className:n().message,children:a})]})}},64785:(e,a,r)=>{"use strict";async function t(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=localStorage.getItem("auth_token"),t=await fetch("".concat("http://localhost:3333/api").concat(e),{headers:{"Content-Type":"application/json",...r&&{Authorization:"Bearer ".concat(r)},...a.headers||{}},...a});if(!t.ok)throw 401===t.status&&(localStorage.removeItem("auth_token"),localStorage.removeItem("auth_user"),window.location.href="/login"),Error((await t.json().catch(()=>({message:t.statusText}))).message||"Erro ao comunicar com a API");return 204===t.status?null:t.json()}function o(){return t("/dados")}function n(e){return t("/dividas",{method:"POST",body:JSON.stringify(e)})}function s(e){return t("/dividas/".concat(e),{method:"DELETE"})}function i(e){return t("/salario",{method:"POST",body:JSON.stringify(e)})}function l(e){return t("/poupanca",{method:"POST",body:JSON.stringify(e)})}function c(e){return t("/meses",{method:"POST",body:JSON.stringify(e)})}function u(e){return t("/preferencias",{method:"POST",body:JSON.stringify(e)})}function d(e){return t("/acoes-rapidas",{method:"POST",body:JSON.stringify(e)})}function m(e){return t("/acoes-rapidas/ordem",{method:"POST",body:JSON.stringify({routeOrder:e})})}function h(e){return t("/acoes-rapidas/".concat(encodeURIComponent(e)),{method:"DELETE"})}function f(e){return t("/usuario",{method:"POST",body:JSON.stringify(e)})}r.d(a,{BH:()=>s,C1:()=>i,IG:()=>m,Nt:()=>l,PK:()=>u,TK:()=>f,UE:()=>h,a1:()=>c,cx:()=>n,dR:()=>o,wn:()=>d})},71056:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>f});var t=r(73365),o=r(1521),n=r(44944),s=r(13876),i=r(78630),l=r(76183),c=r.n(l);function u(e){let{user:a,onSave:r,isLoading:n=!1}=e,[s,i]=(0,o.useState)({name:"",email:"",phone:"",avatar:""});(0,o.useEffect)(()=>{a&&i({name:a.name||"",email:a.email||"",phone:a.phone||"",avatar:a.avatar||""})},[a]);let l=e=>{let{name:a,value:r}=e.target;i(e=>({...e,[a]:r}))},u=async e=>{e.preventDefault(),r&&await r(s)};return(0,t.jsxs)("form",{onSubmit:u,className:c().form,children:[(0,t.jsxs)("div",{className:c().field,children:[(0,t.jsx)("label",{htmlFor:"name",className:c().label,children:"Nome Completo"}),(0,t.jsx)("input",{type:"text",id:"name",name:"name",value:s.name,onChange:l,className:c().input,placeholder:"Digite seu nome completo",required:!0})]}),(0,t.jsxs)("div",{className:c().field,children:[(0,t.jsx)("label",{htmlFor:"email",className:c().label,children:"E-mail"}),(0,t.jsx)("input",{type:"email",id:"email",name:"email",value:s.email,onChange:l,className:c().input,placeholder:"seu@email.com"})]}),(0,t.jsxs)("div",{className:c().field,children:[(0,t.jsx)("label",{htmlFor:"phone",className:c().label,children:"Telefone"}),(0,t.jsx)("input",{type:"tel",id:"phone",name:"phone",value:s.phone,onChange:l,className:c().input,placeholder:"(00) 00000-0000"})]}),(0,t.jsxs)("div",{className:c().field,children:[(0,t.jsx)("label",{htmlFor:"avatar",className:c().label,children:"URL do Avatar (opcional)"}),(0,t.jsx)("input",{type:"url",id:"avatar",name:"avatar",value:s.avatar,onChange:l,className:c().input,placeholder:"https://exemplo.com/avatar.jpg"}),s.avatar&&(0,t.jsx)("div",{className:c().avatarPreview,children:(0,t.jsx)("img",{src:s.avatar,alt:"Preview do avatar",onError:e=>{e.target.style.display="none"}})})]}),(0,t.jsx)("div",{className:c().actions,children:(0,t.jsx)("button",{type:"submit",disabled:n,className:c().submitButton,children:n?"Salvando...":"Salvar Perfil"})})]})}var d=r(56545),m=r(43020),h=r.n(m);function f(){let{data:e,loading:a,refresh:r,saveUser:l,operationLoading:c}=(0,s.c)(),{user:m}=(0,i.A)(),[f,p]=(0,o.useState)("");if(a&&!e||c)return(0,t.jsx)(n.O,{children:(0,t.jsx)(d.x,{message:c?"Processando...":"Carregando dados..."})});async function v(e){try{await l(e),p("Perfil atualizado com sucesso!"),setTimeout(()=>p(""),3e3)}catch(e){p(e.message||"Erro ao atualizar perfil")}}let _=(null==e?void 0:e.user)||m,g=(null==_?void 0:_.avatar)||((null==_?void 0:_.name)?"https://ui-avatars.com/api/?name=".concat(encodeURIComponent(_.name),"&background=6366F1&color=fff&size=200"):null);return(0,t.jsx)(n.O,{children:(0,t.jsxs)("div",{className:h().container,children:[(0,t.jsxs)("div",{className:h().profileHeader,children:[(0,t.jsx)("div",{className:h().avatarContainer,children:g?(0,t.jsx)("img",{src:g,alt:(null==_?void 0:_.name)||"Usu\xe1rio",className:h().avatar,onError:e=>{e.target.src="https://ui-avatars.com/api/?name=".concat(encodeURIComponent((null==_?void 0:_.name)||"U"),"&background=6366F1&color=fff&size=200")}}):(0,t.jsx)("div",{className:h().avatarPlaceholder,children:(0,t.jsx)("span",{className:h().avatarIcon,children:"\uD83D\uDC64"})})}),(0,t.jsxs)("div",{className:h().profileInfo,children:[(0,t.jsx)("h1",{className:h().profileName,children:(null==_?void 0:_.name)||"Usu\xe1rio"}),(0,t.jsx)("p",{className:h().profileEmail,children:(null==_?void 0:_.email)||""})]})]}),f&&(0,t.jsx)("div",{className:"".concat(h().feedback," ").concat(f.includes("Erro")?h().error:h().success),children:f}),(0,t.jsxs)("div",{className:h().formCard,children:[(0,t.jsx)("h2",{className:h().formTitle,children:"Informa\xe7\xf5es Pessoais"}),(0,t.jsx)(u,{user:(null==e?void 0:e.user)||m,onSave:v,isLoading:c})]})]})})}},76183:e=>{e.exports={form:"UserForm_form__hkGm7",field:"UserForm_field__aQ_cU",label:"UserForm_label__caogD",input:"UserForm_input__tifFa",avatarPreview:"UserForm_avatarPreview__yzhcQ",actions:"UserForm_actions__nFnd1",submitButton:"UserForm_submitButton__1xb9E"}},78630:(e,a,r)=>{"use strict";r.d(a,{AuthProvider:()=>d,A:()=>m});var t=r(73365),o=r(1521),n=r(1702);async function s(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let r=await fetch("".concat("http://localhost:3333/api").concat(e),{headers:{"Content-Type":"application/json",...a.headers||{}},...a});if(!r.ok){let e="Erro ao comunicar com a API";try{e=(await r.json()).message||e}catch(a){e=r.statusText||e}throw Error(e)}if(204===r.status)return null;return await r.json()}catch(e){if(e instanceof Error)throw e;throw Error(e.message||"Erro desconhecido")}}async function i(e,a){if(!e||!a)throw Error("Email e senha s\xe3o obrigat\xf3rios");if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.trim()))throw Error("Email inv\xe1lido");return s("/auth/login",{method:"POST",body:JSON.stringify({email:e.trim().toLowerCase(),password:a})})}async function l(e,a){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!e||!a)throw Error("Email e senha s\xe3o obrigat\xf3rios");if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.trim()))throw Error("Email inv\xe1lido");if(a.length<6)throw Error("Senha deve ter no m\xednimo 6 caracteres");return s("/auth/register",{method:"POST",body:JSON.stringify({email:e.trim().toLowerCase(),password:a,name:r.trim()})})}async function c(e){if(!e)throw Error("Token n\xe3o fornecido");return s("/auth/me",{method:"GET",headers:{Authorization:"Bearer ".concat(e)}})}let u=(0,o.createContext)(null);function d(e){let{children:a}=e,[r,s]=(0,o.useState)(null),[d,m]=(0,o.useState)(null),[h,f]=(0,o.useState)(!0),p=(0,n.useRouter)(),v=async e=>{try{let a=await c(e);if(!a||!a.user)throw Error("Resposta inv\xe1lida do servidor");s(a.user),m(e),f(!1)}catch(e){s(null),m(null),localStorage.removeItem("auth_token"),localStorage.removeItem("auth_user"),f(!1)}};(0,o.useEffect)(()=>{(async()=>{let e=localStorage.getItem("auth_token"),a=localStorage.getItem("auth_user");e&&a?(m(e),s(JSON.parse(a)),await v(e)):f(!1)})()},[]);let _=async(e,a)=>{try{let r=await i(e,a);if(!r||!r.user||!r.token)throw Error("Resposta inv\xe1lida do servidor");return s(r.user),m(r.token),localStorage.setItem("auth_token",r.token),localStorage.setItem("auth_user",JSON.stringify(r.user)),r}catch(e){throw e}},g=async(e,a,r)=>{try{let t=await l(e,a,r);if(!t||!t.user||!t.token)throw Error("Resposta inv\xe1lida do servidor");return s(t.user),m(t.token),localStorage.setItem("auth_token",t.token),localStorage.setItem("auth_user",JSON.stringify(t.user)),t}catch(e){throw e}};return(0,t.jsx)(u.Provider,{value:{user:r,token:d,loading:h,login:_,register:g,logout:()=>{s(null),m(null),localStorage.removeItem("auth_token"),localStorage.removeItem("auth_user"),p.push("/login")},isAuthenticated:!!r&&!!d},children:a})}function m(){let e=(0,o.useContext)(u);if(!e)throw Error("useAuth deve ser usado dentro de AuthProvider");return e}},79029:(e,a,r)=>{Promise.resolve().then(r.bind(r,71056))},98027:(e,a,r)=>{"use strict";r.d(a,{H$:()=>n,gm:()=>s,hi:()=>o});let t={data:null,timestamp:null,version:0};function o(){var e;if((e=t)&&e.timestamp&&Date.now()-e.timestamp<3e5&&null!==t.data)try{return JSON.parse(JSON.stringify(t.data))}catch(e){console.warn("Erro ao deserializar cache:",e),s()}return null}function n(e){try{t={data:JSON.parse(JSON.stringify(e)),timestamp:Date.now(),version:t.version+1}}catch(e){console.warn("Erro ao serializar dados para cache:",e)}}function s(){t={data:null,timestamp:null,version:t.version+1}}}},e=>{e.O(0,[487,274,347,131,358],()=>e(e.s=79029)),_N_E=e.O()}]);